<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAHAGIAN I</title>

    <style>
        /* Your existing styles */
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            color: #333;
            padding: 20px;
        }

        h1 {
            color: #0066cc;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            padding: 10px;
            text-align: left;
            border: 1px solid #0066cc;
        }

        th {
            background-color: #0066cc;
            color: white;
        }

        .clear-button,
        .done-button {
            background-color: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px 0;
            cursor: pointer;
        }

        .clear-button:hover,
        .done-button:hover {
            background-color: #005bb5;
        }

        tfoot td {
            font-weight: bold;
            text-align: right;
            background-color: #e0f7ff;
        }

        .tambah-button {
            background-color: #57467B;
            /* Set the background color */
            color: white ;
            /* Set the text color */
            border: none;
            /* No border */
            padding: 5px 10px;
            /* Padding inside button */
            cursor: pointer;
            /* Pointer cursor on hover */
            border-radius: 4px;
            /* Rounded corners */
            transition: background-color 0.3s;
            /* Smooth transition for hover effect */
        }

        .tambah-button:hover {
            background-color: #7CB4B8;
            /* Darker shade on hover */
        }
    </style>
</head>

<body>
    <h1>BAHAGIAN I</h1>

    <h2>BAHAGIAN A</h2>
    <label><b>Membekal dan memasang semua bahan mengikut
spesifikasi piawai JKR secara pendawaian konduit
permukaan atau terbenam dengan menggunakan
kabel PVK yang berikut :-</b></label> 
<br><label><i>(Kadar harga tidak termasuk harga konduit dan trunking
keluli bergalvani)</i></label>

    <table id="data-table-A-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>BAHAGIAN B</h2>
    <label><b>Membekal dan memasang semua bahan mengikut
spesifikasi piawai JKR secara pendawaian permukaan
atau terbenam dengan menggunakan kabel PVK di
dalam konduit / trunking keluli bergalvani l/d
aksessori yang berkaitan.
</b></label>
    <table id="data-table-B-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>BAHAGIAN C</h2>
    <label><b> Membekal dan memasang semua bahan mengikut
spesifikasi piawai JKR secara pendawaian permukaan
atau terbenam dengan menggunakan kabel PVK di
dalam konduit / trunking rigid high impact UPVC l/d
aksessori yang berkaitan. (khusus kawasan berisiko
pengaratan dan berkeperluan sahaja dengan
pejabat Ketua Jurutera Elektrik)
</b></label>
    <table id="data-table-C-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>BAHAGIAN D</h2>
    <label><b>Kabel Polivinil Klorida/Polivinil Klorida (PVK/PVK):-</b><label>
    <br> 
    <br>
    <label><b>Membekal dan memasang kabel submain , di dalam
konduit keluli bergalvani, trunking keluli bergalvani
atau talam penatang kabel keluli bergalvani mengikut
spesifikasi JKR yang berikut:-
</b></label>
<label>(kadar harga tidak termasuk harga konduit / trunking / talam
penatang).</label>
    <table id="data-table-D-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>BAHAGIAN E</h2>
    <label><b>Kabel Polivinil Klorida (PVK):- </b></label>
    <br>
    <br>
    <label><b>Membekal dan memasang kabel submain , di dalam
konduit keluli bergalvani, trunking keluli bergalvani atau
talam penatang kabel keluli bergalvani mengikut
spesifikasi JKR yang berikut:-</b></label>
<br><label><i>(kadar harga tidak termasuk harga konduit / trunking /
talam penatang)</i></label>

    <table id="data-table-E-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>BAHAGIAN F</h2>
    <label><b>Kabel XLPE/PVK:-</b></label>
    <br>
    <br>
    <label><b>Membekal dan memasang kabel submain , di dalam
konduit keluli bergalvani, trunking keluli bergalvani atau
talam penatang kabel keluli bergalvani mengikut
spesifikasi JKR yang berikut:-</b></label>
<br><label><i>(kadar harga tidak termasuk harga konduit / trunking /
talam penatang).</i></label>
    <table id="data-table-F-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>BAHAGIAN G</h2>
    <label><b>Kabel Fire Resistance (FR):-</b></label>
    <br>
    <br> 
    <label><b>Membekal dan memasang kabel submain , di dalam
konduit keluli bergalvani, trunking keluli bergalvani atau
talam penatang kabel keluli bergalvani mengikut
spesifikasi JKR yang berikut:-</b></label>
<label><i>(kadar harga tidak termasuk harga konduit / trunking /
talam penatang).</i></label>
    <table id="data-table-G-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>BAHAGIAN H</h2>
    <label><b>Sistem Perlindungan Kilat dan Sistem Pembumian</b></label>
    <br> 
    <br>
	<label><b>Membekal dan memasang bahagian-bahagian
komponen mengikut spesifikasi JKR yang berikut:-</b></label>
    <table id="data-table-H-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>BAHAGIAN I</h2>
    <label><b>Mata Rangkaian</b></label>
    <br>
    <br>
    <label><b>Membekal dan memasang semua bahan mengikut
spesifikasi piawai JKR</b></label>
	<br>
    <label><i>(Kadar harga tidak termasuk harga patch panel)</i></label>

    <table id="data-table-I-I">
        <thead>
            <tr>
                <th>No.</th>
                <th>Keterangan</th>
                <th>Unit</th>
                <th>Harga Per Unit</th>
                <th>Kuantiti</th>
                <th>Tambah</th>
            </tr>
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated -->
        </tbody>
    </table>

    <h2>ITEM YANG DIPILIH</h2>
    <table id="selected-items-table">
        <thead>
            <tr>
                <th>No</th>
                <th>Keterangan</th>
                <th>Bhg.</th>
                <th>Bil.</th>
                <th>RM</th>
                <th>Kuantiti</th>
                <th>Harga</th>
            </tr>
        </thead>
        <tbody id="selected-items-table-body">
            <!-- Selected items will be displayed here -->
        </tbody>
        <tfoot>
            <tr>
                <td colspan="6">Jumlah Keseluruhan</td>
                <td id="total-amount">RM 0.00</td>
            </tr>
        </tfoot>
    </table>

    <button class="clear-button" onclick="clearAll()">KOSONGKAN SEMUA</button>
    <button class="done-button" onclick="navigateToNextPage()">SELESAI</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>

    <script>
        let selectedItems = [];

        window.onload = function () {
            // Retrieve saved selected items
            const savedItems = localStorage.getItem('selectedItems');
            if (savedItems) {
                selectedItems = JSON.parse(savedItems); // Load into the array
            }
            console.log('Loaded selected items:', selectedItems); // Debugging

            // Reload other data
            loadData('excelDataA-I', 'data-table-A-I', 'I');
            loadData('excelDataB-I', 'data-table-B-I', 'I');
            loadData('excelDataC-I', 'data-table-C-I', 'I');
            loadData('excelDataD-I', 'data-table-D-I', 'I');
            loadData('excelDataE-I', 'data-table-E-I', 'I');
            loadData('excelDataF-I', 'data-table-F-I', 'I');
            loadData('excelDataG-I', 'data-table-G-I', 'I');
            loadData('excelDataH-I', 'data-table-H-I', 'I');
            loadData('excelDataI-I', 'data-table-I-I', 'I');

            // Display saved selected items
            displaySelectedItems();
            updateTotalAmount();
        };

        function navigateToNextPage() {
            console.log('Data before navigating:', localStorage.getItem('selectedItems'));
            window.location.href = 'slip.html';
        }

        function loadData(storageKey, tableId, section) {
            const storedData = localStorage.getItem(storageKey);
            if (storedData) {
                const parsedData = JSON.parse(storedData);
                displayData(parsedData, tableId, section);
            }
        }

        function displayData(data, tableId, section) {
            const tableBody = document.querySelector(`#${tableId} tbody`);
            tableBody.innerHTML = '';

            data.forEach((row, index) => {
                if (row.length < 4 || index === 0) return; // Skip header or invalid rows

                const rowElement = document.createElement('tr');

                rowElement.innerHTML = `
    <td>${row[0]}</td>
    <td>${row[1]}</td>
    <td>${row[2]}</td>
    <td>${parseFloat(row[3]).toFixed(2)}</td>
    <td><input type="number" min="1" value=""></td>
    <td><button class="tambah-button" onclick="addNewItem('${section}', ${index}, this)">Tambah</button></td>
`;

                tableBody.appendChild(rowElement);
            });
        }

        function addNewItem(section, index, button) {
            const row = button.closest('tr').children;
            const quantity = row[4].querySelector('input').value;

            if (!quantity || quantity <= 0) {
                alert('Please enter a valid quantity.');
                return;
            }

            const newItem = {
                section,
                itemNo: row[0].textContent,
                itemName: row[1].textContent,
                itemUnit: row[2].textContent,
                itemPrice: parseFloat(row[3].textContent),
                itemQuantity: parseInt(quantity),
                totalPrice: (parseFloat(row[3].textContent) * parseInt(quantity)).toFixed(2),
            };

            selectedItems.push(newItem);
            localStorage.setItem('selectedItems', JSON.stringify(selectedItems));

            console.log(localStorage.getItem('selectedItems'));

            displaySelectedItems();
            updateTotalAmount();
        }

        function displaySelectedItems() {
            const tableBody = document.querySelector('#selected-items-table-body');
            tableBody.innerHTML = '';

            selectedItems.forEach((item, index) => {
                const rowElement = document.createElement('tr');
                rowElement.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.itemName}</td>
                    <td>${item.section}</td>
                    <td>${item.itemNo}</td>
                    <td>${item.itemPrice.toFixed(2)}</td>
                    <td>${item.itemQuantity}</td>
                    <td>${item.totalPrice}</td>
                `;
                tableBody.appendChild(rowElement);
            });
        }

        function updateTotalAmount() {
            const totalAmount = selectedItems.reduce((sum, item) => sum + parseFloat(item.totalPrice), 0).toFixed(2);
            document.getElementById('total-amount').textContent = `RM ${totalAmount}`;
        }

        function clearAll() {
            selectedItems = [];
            localStorage.removeItem('selectedItems');
            displaySelectedItems();
            updateTotalAmount();
        }
    </script>
</body>

</html>
